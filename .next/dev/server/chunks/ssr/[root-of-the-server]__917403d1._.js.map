{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/LaCie/ai_prod/saas/pages/product.tsx"],"sourcesContent":["\"use client\"\n\nimport { useState, FormEvent } from 'react';\nimport { useAuth } from '@clerk/nextjs';\nimport DatePicker from 'react-datepicker';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\nimport remarkBreaks from 'remark-breaks';\nimport { fetchEventSource } from '@microsoft/fetch-event-source';\nimport { Protect, PricingTable, UserButton } from '@clerk/nextjs';\n\nfunction ConsultationForm() {\n    const { getToken } = useAuth();\n\n    // Form state\n    const [patientName, setPatientName] = useState('');\n    const [visitDate, setVisitDate] = useState<Date | null>(new Date());\n    const [notes, setNotes] = useState('');\n\n    // Streaming state\n    const [output, setOutput] = useState('');\n    const [loading, setLoading] = useState(false);\n\n    async function handleSubmit(e: FormEvent) {\n        e.preventDefault();\n        setOutput('');\n        setLoading(true);\n\n        const jwt = await getToken();\n        if (!jwt) {\n            setOutput('Authentication required');\n            setLoading(false);\n            return;\n        }\n\n        const controller = new AbortController();\n        let buffer = '';\n\n        await fetchEventSource('/api/consultation', {\n            signal: controller.signal,\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                Authorization: `Bearer ${jwt}`,\n            },\n            body: JSON.stringify({\n                patient_name: patientName,\n                date_of_visit: visitDate?.toISOString().slice(0, 10),\n                notes,\n            }),\n            onmessage(ev) {\n                buffer += ev.data;\n                setOutput(buffer);\n            },\n            onclose() { \n                setLoading(false); \n            },\n            onerror(err) {\n                console.error('SSE error:', err);\n                controller.abort();\n                setLoading(false);\n            },\n        });\n    }\n\n    return (\n        <div className=\"container mx-auto px-4 py-12 max-w-3xl\">\n            <h1 className=\"text-4xl font-bold text-gray-900 dark:text-gray-100 mb-8\">\n                Consultation Notes\n            </h1>\n\n            <form onSubmit={handleSubmit} className=\"space-y-6 bg-white dark:bg-gray-800 rounded-xl shadow-lg p-8\">\n                <div className=\"space-y-2\">\n                    <label htmlFor=\"patient\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                        Patient Name\n                    </label>\n                    <input\n                        id=\"patient\"\n                        type=\"text\"\n                        required\n                        value={patientName}\n                        onChange={(e) => setPatientName(e.target.value)}\n                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\n                        placeholder=\"Enter patient's full name\"\n                    />\n                </div>\n\n                <div className=\"space-y-2\">\n                    <label htmlFor=\"date\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                        Date of Visit\n                    </label>\n                    <DatePicker\n                        id=\"date\"\n                        selected={visitDate}\n                        onChange={(d: Date | null) => setVisitDate(d)}\n                        dateFormat=\"yyyy-MM-dd\"\n                        placeholderText=\"Select date\"\n                        required\n                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\n                    />\n                </div>\n\n                <div className=\"space-y-2\">\n                    <label htmlFor=\"notes\" className=\"block text-sm font-medium text-gray-700 dark:text-gray-300\">\n                        Consultation Notes\n                    </label>\n                    <textarea\n                        id=\"notes\"\n                        required\n                        rows={8}\n                        value={notes}\n                        onChange={(e) => setNotes(e.target.value)}\n                        className=\"w-full px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white\"\n                        placeholder=\"Enter detailed consultation notes...\"\n                    />\n                </div>\n\n                <button \n                    type=\"submit\" \n                    disabled={loading}\n                    className=\"w-full bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-semibold py-3 px-6 rounded-lg transition-colors duration-200\"\n                >\n                    {loading ? 'Generating Medical Summary...' : 'Generate Medical Summary'}\n                </button>\n            </form>\n\n            {output && (\n                <section className=\"mt-8 bg-gray-50 dark:bg-gray-800 rounded-xl shadow-lg p-8\">\n                    <div className=\"markdown-content prose prose-blue dark:prose-invert max-w-none\">\n                        <ReactMarkdown remarkPlugins={[remarkGfm, remarkBreaks]}>\n                            {output}\n                        </ReactMarkdown>\n                    </div>\n                </section>\n            )}\n        </div>\n    );\n}\n\nexport default function Product() {\n    return (\n        <main className=\"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800\">\n            {/* User Menu in Top Right */}\n            <div className=\"absolute top-4 right-4\">\n                <UserButton showName={true} />\n            </div>\n\n            {/* Subscription Protection */}\n            <Protect\n                plan=\"subscription_plan\"\n                fallback={\n                    <div className=\"container mx-auto px-4 py-12\">\n                        <header className=\"text-center mb-12\">\n                            <h1 className=\"text-5xl font-bold bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-4\">\n                                Healthcare Professional Plan\n                            </h1>\n                            <p className=\"text-gray-600 dark:text-gray-400 text-lg mb-8\">\n                                Streamline your patient consultations with AI-powered summaries\n                            </p>\n                        </header>\n                        <div className=\"max-w-4xl mx-auto\">\n                            <PricingTable />\n                        </div>\n                    </div>\n                }\n            >\n                <ConsultationForm />\n            </Protect>\n        </main>\n    );\n}"],"names":[],"mappings":"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"}}]
}